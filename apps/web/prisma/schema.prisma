generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Disclosure {
  id        String      @id @default(uuid())
  slug      String      @unique
  manifest  Json
  hashes    Json
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  proofItems ProofItem[]
  receipts  OtsReceipt[]
}

model ProofItem {
  id              String   @id @default(uuid())
  proofId         String
  disclosure      Disclosure @relation(fields: [disclosureId], references: [id], onDelete: Cascade)
  disclosureId    String
  label           String
  kind            String
  path            String?
  mime            String?
  sizeBytes       Int?
  sha256          String
  createdBeforeAi Boolean?
  notes           String?
  gitRepo         String?
  gitCommit       String?
  createdAt       DateTime @default(now())
}

model OtsReceipt {
  id           String   @id @default(uuid())
  disclosure   Disclosure @relation(fields: [disclosureId], references: [id], onDelete: Cascade)
  disclosureId String
  filename     String
  bytes        Bytes
  sha256       String
  createdAt    DateTime @default(now())
}

model Template {
  slug      String   @id
  version   String
  label     String
  json      Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
